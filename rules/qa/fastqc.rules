rule fastqc:
    """
    Computes quality reports for read data sets.
    Note that the 'kind' can be applied to any subdirectory in data/reads.
    E.g. Reads in data/reads/RAW result in a QA report in results/qa/fastqc/RAW
    """
    input: "data/reads/{kind}/{file}.fastq.gz"
    output: expand("results/qa/fastqc{{parameterSet,.*}}/{{kind}}/{{file}}_fastqc.{suf}", suf=["html", "zip"])
    threads: 1
    params:
    	user = lambda wildcards: getParams("fastqc", wildcards.parameterSet),
    	outdir = "results/qa/fastqc{parameterSet}/{kind}"
    shell: "fastqc -t {threads} --outdir {params.outdir} {params.user} {input}"
