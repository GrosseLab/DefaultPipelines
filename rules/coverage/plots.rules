from snakemake.utils import R

ruleorder: plot_hist > plot_regions

rule plot_regions:
    """Produces coverage plots for each gene in the manifest file."""
    input: expand("results/coverage/{{mapper}}{{parameterSet}}/{{ref}}/{{kind}}/{sample}_20_20.cov", sample = config["samples"].keys() )
    output: "plots/coverage/{mapper}{parameterSet}/{ref}/{kind}/{anyregion}.pdf"
    # threads: 48
    script: "coverage_plot.R"

rule plot_CNV_analysis:
  """Shows normalized relative coverages to suggest CNV"""
  input: expand("results/coverage/{{mapper}}{{parameterSet}}/{{ref}}/{{kind}}/{sample}_20_20.cov", sample = config["samples"].keys() )
  output: "plots/CNV/{mapper}{parameterSet}/{ref}/{kind}/{anyregion}.pdf"
  # threads: 48
  script: "CNV_plot.R"

rule plot_hist:
    """Produces a summary plot of target coverage."""
    input: expand("results/coverage/{{mapper}}{{parameterSet}}/{{ref}}/{{kind}}/{sample}_diagnostics_20_20.hist", sample = config["samples"].keys() )
    output: "plots/cum_coverage_goi/{mapper}{parameterSet}/{ref}/{kind}/cumulative_coverage_of_genes_of_interest.pdf"
    script: "coverage_hist.R"
